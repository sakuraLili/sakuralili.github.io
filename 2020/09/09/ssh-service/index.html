<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Docker 镜像添加 SSH 服务 | 既然选择了远方，便只顾风雨兼程</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link ref="icon" href="./public/favicon.icon">
    <meta name="description" content="很多时候，系统管理员都习惯通过 SSH 服务来远程登录管理服务器，但是 Docker 的很多镜像都不带 SSH 服务的，所以需要我们自己自定义镜像来添加 SSH 服务，可以通过下面的方法添加 SSH 服务：

基于 commit 命令创建
基于 Dockerfile 创建

一、基于 commit 命令创建

Docker 提供了 commit 命令，支持用户提交自己对容器的修改，并 ...">
    
    <link rel="preload" href="/assets/css/0.styles.730f6d4f.css" as="style"><link rel="preload" href="/assets/js/app.c4cd884f.js" as="script"><link rel="preload" href="/assets/js/23.d4940eec.js" as="script"><link rel="preload" href="/assets/js/5.5d32c9ea.js" as="script"><link rel="preload" href="/assets/js/15.186b7794.js" as="script"><link rel="prefetch" href="/assets/js/10.a13898e2.js"><link rel="prefetch" href="/assets/js/11.ea480a48.js"><link rel="prefetch" href="/assets/js/12.0623054f.js"><link rel="prefetch" href="/assets/js/13.ef25626c.js"><link rel="prefetch" href="/assets/js/14.37d92c2e.js"><link rel="prefetch" href="/assets/js/16.3a23dbe1.js"><link rel="prefetch" href="/assets/js/17.cf1e4c9d.js"><link rel="prefetch" href="/assets/js/18.733102b1.js"><link rel="prefetch" href="/assets/js/19.eb455b58.js"><link rel="prefetch" href="/assets/js/20.e1adbccc.js"><link rel="prefetch" href="/assets/js/21.70504574.js"><link rel="prefetch" href="/assets/js/22.a40e7218.js"><link rel="prefetch" href="/assets/js/24.e000ab2c.js"><link rel="prefetch" href="/assets/js/25.2fe1472c.js"><link rel="prefetch" href="/assets/js/26.84502e94.js"><link rel="prefetch" href="/assets/js/27.c5d352fe.js"><link rel="prefetch" href="/assets/js/28.8e4ee861.js"><link rel="prefetch" href="/assets/js/29.fb15a9ed.js"><link rel="prefetch" href="/assets/js/3.2bd813b0.js"><link rel="prefetch" href="/assets/js/30.baf8f290.js"><link rel="prefetch" href="/assets/js/31.369fdd21.js"><link rel="prefetch" href="/assets/js/32.c0176c82.js"><link rel="prefetch" href="/assets/js/33.b3200294.js"><link rel="prefetch" href="/assets/js/34.08880f00.js"><link rel="prefetch" href="/assets/js/35.133a227c.js"><link rel="prefetch" href="/assets/js/36.293f2b2b.js"><link rel="prefetch" href="/assets/js/37.f92a5aa5.js"><link rel="prefetch" href="/assets/js/38.11242c63.js"><link rel="prefetch" href="/assets/js/39.1540f3d9.js"><link rel="prefetch" href="/assets/js/4.dde594c9.js"><link rel="prefetch" href="/assets/js/40.bc77545d.js"><link rel="prefetch" href="/assets/js/41.fe6b364e.js"><link rel="prefetch" href="/assets/js/42.6b17d3ae.js"><link rel="prefetch" href="/assets/js/43.d988bf22.js"><link rel="prefetch" href="/assets/js/44.9b709226.js"><link rel="prefetch" href="/assets/js/45.0797ebde.js"><link rel="prefetch" href="/assets/js/46.d41406d1.js"><link rel="prefetch" href="/assets/js/47.26d992a5.js"><link rel="prefetch" href="/assets/js/48.edf0660d.js"><link rel="prefetch" href="/assets/js/49.e1bd4b64.js"><link rel="prefetch" href="/assets/js/50.17997f4a.js"><link rel="prefetch" href="/assets/js/51.0731d59f.js"><link rel="prefetch" href="/assets/js/52.718863ae.js"><link rel="prefetch" href="/assets/js/53.4d2f7088.js"><link rel="prefetch" href="/assets/js/54.91ac93f6.js"><link rel="prefetch" href="/assets/js/55.3216e5c5.js"><link rel="prefetch" href="/assets/js/56.a2736731.js"><link rel="prefetch" href="/assets/js/57.93476b89.js"><link rel="prefetch" href="/assets/js/58.9984e9d6.js"><link rel="prefetch" href="/assets/js/59.27eeb159.js"><link rel="prefetch" href="/assets/js/6.e9162c19.js"><link rel="prefetch" href="/assets/js/60.83f3f7cd.js"><link rel="prefetch" href="/assets/js/61.322f6435.js"><link rel="prefetch" href="/assets/js/62.af66f292.js"><link rel="prefetch" href="/assets/js/63.777e9119.js"><link rel="prefetch" href="/assets/js/64.05118592.js"><link rel="prefetch" href="/assets/js/65.9ba14b43.js"><link rel="prefetch" href="/assets/js/66.62408b82.js"><link rel="prefetch" href="/assets/js/67.fa72ffa1.js"><link rel="prefetch" href="/assets/js/68.c16dfb41.js"><link rel="prefetch" href="/assets/js/7.f41c39e4.js"><link rel="prefetch" href="/assets/js/8.cd0ad175.js"><link rel="prefetch" href="/assets/js/9.f1977faa.js"><link rel="prefetch" href="/assets/js/vuejs-paginate.8fa4990d.js">
    <link rel="stylesheet" href="/assets/css/0.styles.730f6d4f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div id="vuepress-theme-blog__global-layout"><section id="header-wrapper"><header id="header"><div class="header-wrapper"><div class="title"><a href="/" class="nav-link home-link">既然选择了远方，便只顾风雨兼程 </a></div> <div class="header-right-wrap"><ul class="nav"><li class="nav-item"><a href="/" class="nav-link">Blog</a></li><li class="nav-item"><a href="/tag/" class="nav-link">Tags</a></li><li class="nav-item"><a href="/2019/10/20/base-list/" class="nav-link">学习资源</a></li><li class="nav-item"><a href="/handbook/" class="nav-link">前端学习手册</a></li><li class="nav-item"><a href="/tag/Reading%20Notes/" class="nav-link">读书笔记</a></li></ul> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></div></header></section> <div id="mobile-header"><div class="mobile-header-bar"><div class="mobile-header-title"><a href="/" class="nav-link mobile-home-link">既然选择了远方，便只顾风雨兼程 </a> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></div> <div class="mobile-menu-wrapper"><hr class="menu-divider"> <ul class="mobile-nav"><li class="mobile-nav-item"><a href="/" class="nav-link">Blog</a></li><li class="mobile-nav-item"><a href="/tag/" class="nav-link">Tags</a></li><li class="mobile-nav-item"><a href="/2019/10/20/base-list/" class="nav-link">学习资源</a></li><li class="mobile-nav-item"><a href="/handbook/" class="nav-link">前端学习手册</a></li><li class="mobile-nav-item"><a href="/tag/Reading%20Notes/" class="nav-link">读书笔记</a></li> <li class="mobile-nav-item"><!----></li></ul></div></div></div> <div class="content-wrapper"><div id="vuepress-theme-blog__post-layout"><article itemscope="itemscope" itemtype="https://schema.org/BlogPosting" class="vuepress-blog-theme-content"><header><h1 itemprop="name headline" class="post-title">
        Docker 镜像添加 SSH 服务
      </h1> <div class="post-meta"><div itemprop="publisher author" itemtype="http://schema.org/Person" itemscope="itemscope" class="post-meta-author"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-navigation"><polygon points="3 11 22 2 13 21 11 13 3 11"></polygon></svg> <span itemprop="name">lili</span> <span itemprop="address">   in shenzhen</span></div> <div class="post-meta-date"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg> <time pubdate itemprop="datePublished" datetime="2020-09-09T00:00:00.000Z">
      Wed Sep 09 2020
    </time></div> <ul itemprop="keywords" class="post-meta-tags"><li class="post-tag" data-v-42ccfcd5><a href="/tag/Docker" data-v-42ccfcd5><span data-v-42ccfcd5>Docker</span></a></li></ul></div></header> <div itemprop="articleBody" class="content__default"><p>很多时候，系统管理员都习惯通过 SSH 服务来远程登录管理服务器，但是 Docker 的很多镜像都不带 SSH 服务的，所以需要我们自己自定义镜像来添加 SSH 服务，可以通过下面的方法添加 SSH 服务：</p> <ul><li>基于 commit 命令创建</li> <li>基于 Dockerfile 创建</li></ul> <h2 id="一、基于-commit-命令创建"><a href="#一、基于-commit-命令创建" class="header-anchor">#</a> 一、基于 commit 命令创建</h2> <p>Docker 提供了 commit 命令，支持用户提交自己对容器的修改，并生成新的镜像。命令格式为：</p> <blockquote><p>docker commit CONTAINER [REPOSITORY[:TAG]]</p></blockquote> <h3 id="_1-创建-ubuntu-容器"><a href="#_1-创建-ubuntu-容器" class="header-anchor">#</a> 1. 创建 Ubuntu 容器</h3> <p>首先，获取 ubuntu:18.04镜像，然后创建一个容器，并在其中运行 bash 应用：</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">docker</span> pull ubuntu:18.04
<span class="token function">docker</span> run <span class="token parameter variable">-it</span> ubuntu:18.04 <span class="token function">bash</span>
</code></pre></div><h3 id="_2-检查软件源"><a href="#_2-检查软件源" class="header-anchor">#</a> 2. 检查软件源</h3> <p>第二步，检查软件源，并使用 apt-get update 命令来更新软件源信息：</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">apt-get</span> update
</code></pre></div><p>执行这个命令还是十分有必要的</p> <p>如果没有执行这个命令，后面 install 一些工具时，可能会报错，说找不到 package：</p> <p><img src="/assets/img/13.fe27b392.png" alt="image from dependency"></p> <p>这都是因为没有执行 apt-get update命令，执行后就可以 install 了</p> <h3 id="_3-安装和配置-ssh-服务"><a href="#_3-安装和配置-ssh-服务" class="header-anchor">#</a> 3. 安装和配置 SSH 服务</h3> <p>第三步，安装和配置 SSH 服务。</p> <p>选择 openssh-server 作为服务端：</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">apt-get</span> <span class="token function">install</span> openssh-server
</code></pre></div><p>如果需要正常启动 SSH 服务，目录 /var/run/sshd 必须存在，这里需要手动创建它，并启动 SSH 服务：</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">mkdir</span> <span class="token parameter variable">-p</span> /var/run/sshd
/usr/sbin/sshd <span class="token parameter variable">-D</span> <span class="token operator">&amp;</span>
</code></pre></div><p>此时，用下面的命令查看容器的22端口(SSH服务默认监听的端口)，可以发现22端口已经处于监听状态。</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">netstat</span> <span class="token parameter variable">-tunlp</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token number">22</span>
</code></pre></div><p>结果如图：</p> <p><img src="/assets/img/05.be07a954.png" alt="image from dependency"></p> <p>这时可能会报错：</p> <p><img src="/assets/img/04.7c71bb9f.png" alt="image from dependency"></p> <p>这是由于网络工具没有安装，执行下面的命令就可以了：</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">apt-get</span> <span class="token function">install</span> net-tools
</code></pre></div><p>修改 SSH 服务的安全登录配置，取消 pam 登录限制：</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">sed</span> <span class="token parameter variable">-ri</span> <span class="token string">'s/session required pam_loginuid.so/#session required pam_loginuid.so/g'</span> /etc/pam.d/sshd
</code></pre></div><p>在 root 用户目录下创建 .ssh 目录，并复制需要登录的公钥信息(一般为本地主机用户目录下的<code>.ssh/id_rsa.pub</code>文件)到authorized_keys文件中：</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">mkdir</span> root/.ssh
<span class="token function">vi</span> /root/.ssh/authorized_keys
</code></pre></div><p>这里同样可能会报错，说vi: command not found，执行install 命令就可以了：</p> <p><img src="/assets/img/07.9745243d.png" alt="image from dependency"></p> <p>创建自动启动 SSH 服务的可执行文件 run.sh，并添加可执行权限：</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">vi</span> /run.sh
<span class="token function">chmod</span> +x run.sh
</code></pre></div><p>run.sh 脚本内容如下：</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token shebang important">#!/bin/bash</span>
/usr/sbin/sshd <span class="token parameter variable">-D</span>
</code></pre></div><p>最后，输入exit，退出容器</p> <h3 id="_4-保存镜像"><a href="#_4-保存镜像" class="header-anchor">#</a> 4. 保存镜像</h3> <p>首先，使用 docker ps -a 命令查看容器：</p> <p><img src="/assets/img/09.e3d2970e.png" alt="image from dependency"></p> <p>这里可以看到<strong>容器的ID</strong></p> <p>然后用 docker commit 命令将容器保存为一个新的 sshd:ubuntu 镜像</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">docker</span> commit 36f9aa524dd4 sshd:ubuntu
</code></pre></div><p>创建成功后，我们可以用 docker images 命令查看一下镜像:</p> <p><img src="/assets/img/11.327b1be6.png" alt="image from dependency"></p> <h3 id="_5-使用镜像"><a href="#_5-使用镜像" class="header-anchor">#</a> 5. 使用镜像</h3> <p>启动容器，并添加端口映射 10022 -&gt; 22，其中 10022 是宿主主机的端口，22是容器的 SSH 服务监听的端口：</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">docker</span> run <span class="token parameter variable">-p</span> <span class="token number">10022</span>:22 <span class="token parameter variable">-d</span> sshd:ubuntu /run.sh
</code></pre></div><p>确保宿主主机对外端口10022对外防火墙已经打开</p> <p>最后，在宿主主机(192.168.1.200)或其他主机上，通过 SSH 访问端口来登录容器：</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">ssh</span> <span class="token number">192.168</span>.1.200 <span class="token parameter variable">-p</span> <span class="token number">10022</span>
</code></pre></div><h3 id="_6-替换镜像源"><a href="#_6-替换镜像源" class="header-anchor">#</a> 6. 替换镜像源</h3> <p>如果官方镜像速度慢的话，可以替换成国内的163、sohu 等镜像的源。以163源为例，在容器内创建/etc/apt/sources.list.d/163.list 文件：</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">vi</span> /etc/apt/sources.list.d/163.list
</code></pre></div><p>添加如下内容到文件中:</p> <div class="language- extra-class"><pre class="language-text"><code>deb http://mirrors.163.com/ubuntu/ bionic main restricted universe multiverse
deb http://mirrors.163.com/ubuntu/ bionic-security main restricted universe multiverse
deb http://mirrors.163.com/ubuntu/ bionic-updates main restricted universe multiverse
deb http://mirrors.163.com/ubuntu/ bionic-proposed main restricted universe multiverse
deb http://mirrors.163.com/ubuntu/ bionic-backports main restricted universe multiverse
deb-src http://mirrors.163.com/ubuntu/ bionic main restricted universe multiverse
deb-src http://mirrors.163.com/ubuntu/ bionic-security main restricted universe multiverse
deb-src http://mirrors.163.com/ubuntu/ bionic-updates main restricted universe multiverse
deb-src http://mirrors.163.com/ubuntu/ bionic-proposed main restricted universe multiverse
deb-src http://mirrors.163.com/ubuntu/ bionic-backports main restricted universe multiverse
</code></pre></div><p>之后重新执行 apt-get update 命令就可以了。</p> <h2 id="二、基于-dockerfile-创建"><a href="#二、基于-dockerfile-创建" class="header-anchor">#</a> 二、基于 Dockerfile 创建</h2> <h3 id="_1-创建工作目录"><a href="#_1-创建工作目录" class="header-anchor">#</a> 1. 创建工作目录</h3> <p>首先，创建一个 sshd_ubuntu 工作目录：</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">mkdir</span> sshd_ubuntu
</code></pre></div><p>在工作目录中，创建Dockerfile 和 run.sh 文件</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token builtin class-name">cd</span> sshd_ubuntu/
<span class="token function">touch</span> Dockerfile run.sh
</code></pre></div><h3 id="_2-编写-run-sh-脚本和-authorized-keys-文件"><a href="#_2-编写-run-sh-脚本和-authorized-keys-文件" class="header-anchor">#</a> 2. 编写 run.sh 脚本和 authorized_keys 文件</h3> <p>run.sh 的内容和上面一样：</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token shebang important">#!/bin/bash</span>
/usr/sbin/sshd <span class="token parameter variable">-D</span>
</code></pre></div><p>在宿主主机上生成 SSH 密钥对，并创建 authorized_keys 文件：</p> <div class="language-sh extra-class"><pre class="language-sh"><code>ssh-keygen <span class="token parameter variable">-t</span> rsa
<span class="token function">cat</span> ~/.ssh/id_rsa.pub <span class="token operator">&gt;</span> authorized_keys
</code></pre></div><h3 id="_3-编写-dockerfile"><a href="#_3-编写-dockerfile" class="header-anchor">#</a> 3. 编写 Dockerfile</h3> <div class="language-docker extra-class"><pre class="language-docker"><code><span class="token comment"># 设置继承镜像</span>
<span class="token instruction"><span class="token keyword">FROM</span> ubuntu:18.04</span>

<span class="token comment"># 提供一些作者的信息</span>
<span class="token instruction"><span class="token keyword">MAINTAINER</span>  docker_user(user@docker.com)</span>

<span class="token comment"># 更改 ubuntu 的源为国内 163 的源</span>
<span class="token instruction"><span class="token keyword">RUN</span> echo <span class="token string">&quot;deb http://mirrors.163.com/ubuntu/ bionic main restricted universe multiverse&quot;</span> &gt; /etc/apt/sources.list</span>
<span class="token instruction"><span class="token keyword">RUN</span> echo <span class="token string">&quot;deb http://mirrors.163.com/ubuntu/ bionic-security main restricted universe multiverse&quot;</span> &gt;&gt; /etc/apt/sources.list</span>
<span class="token instruction"><span class="token keyword">RUN</span> echo <span class="token string">&quot;deb http://mirrors.163.com/ubuntu/ bionic-updates main restricted universe multiverse&quot;</span> &gt;&gt; /etc/apt/sources.list</span>
<span class="token instruction"><span class="token keyword">RUN</span> echo <span class="token string">&quot;deb http://mirrors.163.com/ubuntu/ bionic-proposed main restricted universe multiverse&quot;</span> &gt;&gt; /etc/apt/sources.list</span>
<span class="token instruction"><span class="token keyword">RUN</span> echo <span class="token string">&quot;deb http://mirrors.163.com/ubuntu/ bionic-backports main restricted universe multiverse&quot;</span> &gt;&gt; /etc/apt/sources.list</span>

<span class="token instruction"><span class="token keyword">RUN</span> apt-get update</span>

<span class="token comment"># 安装 ssh 服务</span>
<span class="token instruction"><span class="token keyword">RUN</span> apt-get install -y openssh-server</span>
<span class="token instruction"><span class="token keyword">RUN</span> mkdir -p /var/run/sshd</span>
<span class="token instruction"><span class="token keyword">RUN</span> mkdir -p /root/.ssh</span>

<span class="token comment"># 取消 pam 限制</span>
<span class="token instruction"><span class="token keyword">RUN</span> sed -ri <span class="token string">'s/session required pam_loginuid.so/#session required pam_loginuid.so/g'</span> /etc/pam.d/sshd</span>

<span class="token comment"># 复制配置文件到相应位置，并赋予脚本可执行权限</span>
<span class="token instruction"><span class="token keyword">ADD</span> authorized_keys /root/.ssh/authorized_keys</span>
<span class="token instruction"><span class="token keyword">ADD</span> run.sh /run.sh</span>
<span class="token instruction"><span class="token keyword">RUN</span> chmod 755 /run.sh</span>

<span class="token comment"># 开放端口</span>
<span class="token instruction"><span class="token keyword">EXPOSE</span> 22</span>

<span class="token comment"># 设置自启动命令</span>
<span class="token instruction"><span class="token keyword">CMD</span> [<span class="token string">&quot;/run.sh&quot;</span>]</span>
</code></pre></div><h4 id="_4-创建镜像"><a href="#_4-创建镜像" class="header-anchor">#</a> 4. 创建镜像</h4> <p>在 sshd_ubuntu 目录下，使用 docker build 命令来创建镜像。</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token builtin class-name">cd</span> sshd_ubuntu
<span class="token function">docker</span> build <span class="token parameter variable">-t</span> sshd:dockerfile <span class="token builtin class-name">.</span>
</code></pre></div><p>当使用 Dockerfile创建自定义镜像时，Docker 会自动删除中间临时创建的层。</p> <p>命令执行完毕后，如果看见“Successfully built XXX”字样，则说明镜像创建成功。</p> <p>然后可以使用 docker images 命令查看已存在的镜像。</p> <h3 id="_5-使用镜像-2"><a href="#_5-使用镜像-2" class="header-anchor">#</a> 5. 使用镜像</h3> <p>直接启动镜像，映射容器的 22 端口 到本地的 10122 端口：</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-p</span> <span class="token number">10122</span>:22 sshd:dockerfile
<span class="token function">docker</span> <span class="token function">ps</span>
</code></pre></div><p>在宿主主机(192.168.1.200)或其他主机上，通过 SSH 访问端口来登录容器：</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">ssh</span> <span class="token number">192.168</span>.1.200 <span class="token parameter variable">-p</span> <span class="token number">10022</span>
</code></pre></div><h2 id="参考文献"><a href="#参考文献" class="header-anchor">#</a> 参考文献</h2> <p>Docker技术入门与实战(第3版)</p></div> <footer><!----> <hr> <!----></footer></article> <div class="sticker vuepress-toc"><div class="vuepress-toc-item vuepress-toc-h2 active"><a href="#一、基于-commit-命令创建" title="一、基于 commit 命令创建">一、基于 commit 命令创建</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#_1-创建-ubuntu-容器" title="1. 创建 Ubuntu 容器">1. 创建 Ubuntu 容器</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#_2-检查软件源" title="2. 检查软件源">2. 检查软件源</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#_3-安装和配置-ssh-服务" title="3. 安装和配置 SSH 服务">3. 安装和配置 SSH 服务</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#_4-保存镜像" title="4. 保存镜像">4. 保存镜像</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#_5-使用镜像" title="5. 使用镜像">5. 使用镜像</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#_6-替换镜像源" title="6. 替换镜像源">6. 替换镜像源</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#二、基于-dockerfile-创建" title="二、基于 Dockerfile 创建">二、基于 Dockerfile 创建</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#_1-创建工作目录" title="1. 创建工作目录">1. 创建工作目录</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#_2-编写-run-sh-脚本和-authorized-keys-文件" title="2. 编写 run.sh 脚本和 authorized_keys 文件">2. 编写 run.sh 脚本和 authorized_keys 文件</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#_3-编写-dockerfile" title="3. 编写 Dockerfile">3. 编写 Dockerfile</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#_5-使用镜像-2" title="5. 使用镜像">5. 使用镜像</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#参考文献" title="参考文献">参考文献</a></div></div></div></div> <footer class="footer" data-v-3d9deeb8><div class="footer-left-wrap" data-v-3d9deeb8><ul class="contact" data-v-3d9deeb8></ul></div> <div class="footer-right-wrap" data-v-3d9deeb8><ul class="copyright" data-v-3d9deeb8></ul></div></footer></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.c4cd884f.js" defer></script><script src="/assets/js/23.d4940eec.js" defer></script><script src="/assets/js/5.5d32c9ea.js" defer></script><script src="/assets/js/15.186b7794.js" defer></script>
  </body>
</html>
